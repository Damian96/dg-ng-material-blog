import { Injectable } from "@angular/core";

import { getAuth, Auth, User, createUserWithEmailAndPassword } from "firebase/auth";
import { EMPTY, Observable, Subscription, from, pipe } from 'rxjs';

@Injectable({
  providedIn: 'root',
})
export class AuthService {

  user: Observable<User | null> = EMPTY;
  #auth: Auth;

  constructor() {
    this.#auth = getAuth();
  }

  showLoginButton = false;
  showLogoutButton = false;


  register(email: string, password: string): Observable<User | false> {
    from(createUserWithEmailAndPassword(this.#auth, email, password))
      .subscribe((userCredential) => {
        const user = userCredential.user;

        console.log(`Signed user in with UID ${user.uid}`);
        return user;
      }, (error) => {
        const errorCode = error.code;
        const errorMessage = error.message;

        return false;
      });

    return EMPTY;
  }

  isLoggedIn(): boolean {
    return this.#auth.currentUser != null;
  }

}
